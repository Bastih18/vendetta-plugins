(function(f,a,i,c,P,m){"use strict";const{View:T,Text:u,Pressable:B}=a.findByProps("Button","Text","View"),R=a.findByProps("extractTimestamp"),r=i.stylesheet.createThemedStyleSheet({container:{flex:1,padding:16,alignItems:"center",justifyContent:"center"},title:{fontFamily:i.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:24,textAlign:"left",color:P.semanticColors.HEADER_PRIMARY,paddingVertical:25},text:{flex:1,flexDirection:"row",fontSize:16,textAlign:"justify",color:P.semanticColors.HEADER_PRIMARY},dateContainer:{height:16,alignSelf:"baseline"}});function g(e){let{date:n}=e;return React.createElement(B,{style:r.dateContainer,onPress:function(){i.toasts.open({content:i.moment(n).toLocaleString(),source:m.getAssetByName("clock").id})},onLongPress:function(){i.clipboard.setString(n.getTime().toString()),i.toasts.open({content:"Copied to clipboard"})}},React.createElement(u,{style:r.text},i.moment(n).fromNow()))}function D(e){let{channel:n}=e;return React.createElement(T,{style:r.container},React.createElement(u,{style:r.title},"This channel is hidden."),React.createElement(u,{style:r.text},"Topic: ",n.topic||"No topic.",`

`,"Creation date: ",React.createElement(g,{date:new Date(R.extractTimestamp(n.id))}),`

`,"Last message: ",n.lMsg?React.createElement(g,{date:new Date(R.extractTimestamp(n.lMsg))}):"No messages.",`

`,"Last pin: ",n.lastPinTimestamp?React.createElement(g,{date:new Date(n.lastPinTimestamp)}):"No pins."))}let l=[];const E=a.findByProps("getChannelPermissions","can"),S=a.findByProps("transitionToGuild"),x=a.findByProps("stores","fetchMessages"),{ChannelTypes:h}=a.findByProps("ChannelTypes"),{getChannel:p}=a.findByProps("getChannel"),y=a.findByStoreName("ReadStateStore");a.findByStoreName("ChannelStore");const _=[h.DM,h.GROUP_DM,h.GUILD_CATEGORY];function d(e){if(e==null||(typeof e=="string"&&(e=p(e)),!e||_.includes(e.type)))return!1;e.realCheck=!0;let n=!E.can(i.constants.Permissions.VIEW_CHANNEL,e);return delete e.realCheck,n}function M(){console.log("HiddenChannel loaded 4.5");const e=a.findByName("MessagesWrapperConnected",!1);console.log("Patch getForDebugging");const n=c.after("getForDebugging",y,function(s,t){return console.log("HiddenChannel: Patching channel overrides"),l.push(c.before("canBeUnread",t.__proto__,function(){if(d(p(this.channelId)))return!1})),n(),t});console.log("HiddenChannel: Patching channel overrides done"),l.push(c.instead("hasUnread",y,function(s,t){const o=p(s[0]);return d(o)?(y.getForDebugging(o.id),!1):t(s)})),l.push(c.after("can",E,function(s,t){let[o,C]=s;return!C?.realCheck&&o===i.constants.Permissions.VIEW_CHANNEL?!0:t})),l.push(c.instead("transitionToGuild",S,function(s,t){const[o,C]=s;!d(C)&&typeof t=="function"&&t(s)})),l.push(c.instead("fetchMessages",x,function(s,t){const[o]=s;!d(o)&&typeof t=="function"&&t(s)})),l.push(c.instead("default",e,function(s,t){const o=s[0]?.channel;return!d(o)&&typeof t=="function"?t(...s):i.React.createElement(D,{channel:o})}))}var N={onLoad:M,onUnload:function(){for(const e of l)e()}};return f.default=N,Object.defineProperty(f,"__esModule",{value:!0}),f})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui,vendetta.ui.assets);
