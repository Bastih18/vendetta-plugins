(function(p,a,r,i,m,B,A,M){"use strict";var f;(function(e){e[e.BUILT_IN=0]="BUILT_IN",e[e.BUILT_IN_TEXT=1]="BUILT_IN_TEXT",e[e.BUILT_IN_INTEGRATION=2]="BUILT_IN_INTEGRATION",e[e.BOT=3]="BOT",e[e.PLACEHOLDER=4]="PLACEHOLDER"})(f||(f={}));var R;(function(e){e[e.SUB_COMMAND=1]="SUB_COMMAND",e[e.SUB_COMMAND_GROUP=2]="SUB_COMMAND_GROUP",e[e.STRING=3]="STRING",e[e.INTEGER=4]="INTEGER",e[e.BOOLEAN=5]="BOOLEAN",e[e.USER=6]="USER",e[e.CHANNEL=7]="CHANNEL",e[e.ROLE=8]="ROLE",e[e.MENTIONABLE=9]="MENTIONABLE",e[e.NUMBER=10]="NUMBER",e[e.ATTACHMENT=11]="ATTACHMENT"})(R||(R={}));var u;(function(e){e[e.CHAT=1]="CHAT",e[e.USER=2]="USER",e[e.MESSAGE=3]="MESSAGE"})(u||(u={}));const{View:_,Text:T,Pressable:S}=a.findByProps("Button","Text","View"),g=a.findByProps("extractTimestamp"),o=i.stylesheet.createThemedStyleSheet({container:{flex:1,padding:16,alignItems:"center",justifyContent:"center"},title:{fontFamily:i.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:24,textAlign:"left",color:A.semanticColors.HEADER_PRIMARY,paddingVertical:25},text:{flex:1,flexDirection:"row",fontSize:16,textAlign:"justify",color:A.semanticColors.HEADER_PRIMARY},dateContainer:{height:16,alignSelf:"baseline"}});function N(e){let{date:t}=e;return React.createElement(S,{style:o.dateContainer,onPress:function(){i.toasts.open({content:i.moment(t).toLocaleString(),source:M.getAssetByName("clock").id})},onLongPress:function(){i.clipboard.setString(t.getTime().toString()),i.toasts.open({content:"Copied to clipboard"})}},React.createElement(T,{style:o.text},i.moment(t).fromNow()))}function L(e){let{channel:t}=e;return React.createElement(_,{style:o.container},React.createElement(T,{style:o.title},"This channel is hidden."),React.createElement(T,{style:o.text},"Topic: ",t.topic||"No topic.",`

`,"Creation date: ",React.createElement(N,{date:new Date(g.extractTimestamp(t.id))}),`

`,"Last message: ",t.lMsg?React.createElement(N,{date:new Date(g.extractTimestamp(t.lMsg))}):"No messages.",`

`,"Last pin: ",t.lastPinTimestamp?React.createElement(N,{date:new Date(t.lastPinTimestamp)}):"No pins."))}let l=[];const C=a.findByProps("getChannelPermissions","can"),O=a.findByProps("transitionToGuild"),P=a.findByProps("stores","fetchMessages"),{ChannelTypes:y}=a.findByProps("ChannelTypes"),{getChannel:U}=a.findByProps("getChannel");a.findByProps("bulkAck"),a.findByStoreName("ReadStateStore"),a.findByStoreName("ChannelStore");const E=[y.DM,y.GROUP_DM,y.GUILD_CATEGORY],h=new Map;function d(e){if(e==null||(typeof e=="string"&&(e=U(e)),!e||E.includes(e.type)))return!1;e.realCheck=!0;let t=!C.can(i.constants.Permissions.VIEW_CHANNEL,e);return delete e.realCheck,t}function D(e){var t=h.get(e.guild_id);t||(t=[]),t.includes(e.id)||t.push({channelId:e.id,messageId:e.lastMessageId}),h.set(e.guild_id,t)}let I;function G(){console.log("HiddenChannel 5.1 loaded"),I=m.registerCommand({name:"markhiddenread",displayName:"markhiddenread",description:"mark all hidden channels in this guild as read",displayDescription:"mark all hidden channels in this guild as read",options:[],inputType:f.BUILT_IN_TEXT,type:u.CHAT,execute:async function(t,n){try{console.log(n)}catch(s){console.log(s),B.logger.error(s)}}});const e=a.findByName("MessagesWrapperConnected",!1);l.push(r.after("can",C,function(t,n){let[s,c]=t;return!c?.realCheck&&s===i.constants.Permissions.VIEW_CHANNEL?(d(c)&&D(c),!0):n})),l.push(r.instead("transitionToGuild",O,function(t,n){const[s,c]=t;!d(c)&&typeof n=="function"&&n(t)})),l.push(r.instead("fetchMessages",P,function(t,n){const[s]=t;!d(s)&&typeof n=="function"&&n(t)})),l.push(r.instead("default",e,function(t,n){const s=t[0]?.channel;return!d(s)&&typeof n=="function"?n(...t):i.React.createElement(L,{channel:s})}))}var H={onLoad:G,onUnload:function(){I();for(const e of l)e()}};return p.default=H,Object.defineProperty(p,"__esModule",{value:!0}),p})({},vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.commands,vendetta,vendetta.ui,vendetta.ui.assets);
