(function(g,s,a,o,C,M){"use strict";const{View:m,Text:h,Pressable:T}=s.findByProps("Button","Text","View"),P=s.findByProps("extractTimestamp"),d=a.stylesheet.createThemedStyleSheet({container:{flex:1,padding:16,alignItems:"center",justifyContent:"center"},title:{fontFamily:a.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:24,textAlign:"left",color:C.semanticColors.HEADER_PRIMARY,paddingVertical:25},text:{flex:1,flexDirection:"row",fontSize:16,textAlign:"justify",color:C.semanticColors.HEADER_PRIMARY},dateContainer:{height:16,alignSelf:"baseline"}});function p(t){let{date:e}=t;return React.createElement(T,{style:d.dateContainer,onPress:function(){a.toasts.open({content:a.moment(e).toLocaleString(),source:M.getAssetByName("clock").id})},onLongPress:function(){a.clipboard.setString(e.getTime().toString()),a.toasts.open({content:"Copied to clipboard"})}},React.createElement(h,{style:d.text},a.moment(e).fromNow()))}function D(t){let{channel:e}=t;return React.createElement(m,{style:d.container},React.createElement(h,{style:d.title},"This channel is hidden."),React.createElement(h,{style:d.text},"Topic: ",e.topic||"No topic.",`

`,"Creation date: ",React.createElement(p,{date:new Date(P.extractTimestamp(e.id))}),`

`,"Last message: ",e.lMsg?React.createElement(p,{date:new Date(P.extractTimestamp(e.lMsg))}):"No messages.",`

`,"Last pin: ",e.lastPinTimestamp?React.createElement(p,{date:new Date(e.lastPinTimestamp)}):"No pins."))}let l=[];const R=s.findByProps("getChannelPermissions","can"),B=s.findByProps("transitionToGuild"),I=s.findByProps("stores","fetchMessages"),{ChannelTypes:y}=s.findByProps("ChannelTypes"),{getChannel:c}=s.findByProps("getChannel"),f=s.findByStoreName("ReadStateStore");s.findByStoreName("ChannelStore");const S=[y.DM,y.GROUP_DM,y.GUILD_CATEGORY];function r(t){if(t==null||(typeof t=="string"&&(t=c(t)),!t||S.includes(t.type)))return!1;t.realCheck=!0;let e=!R.can(a.constants.Permissions.VIEW_CHANNEL,t);return delete t.realCheck,e}function E(t){r(t)&&((t.lMsg==null||t.lMsg!=t.lastMessageId)&&t.lastMessageId!=null&&(t.lMsg=t.lastMessageId),t.lastMessageId=void 0)}function _(){console.log("HiddenChannel loaded 5.0");const t=s.findByName("MessagesWrapperConnected",!1);console.log("Patch getForDebugging"),o.after("getForDebugging",f,function(e,n){if(console.log("HiddenChannel: Patching channel overrides"),n!=null)return l.push(o.before("canBeUnread",n.__proto__,function(){if(r(c(this.channelId)))return E(c(this.channelId)),!1})),n},!0),console.log("HiddenChannel: Patching channel overrides done"),l.push(o.instead("hasUnread",f,function(e,n){const i=c(e[0]);return r(i)?(f.getForDebugging(c(i.id)),!1):n(e)})),l.push(o.after("can",R,function(e,n){let[i,u]=e;return!u?.realCheck&&i===a.constants.Permissions.VIEW_CHANNEL?(f.getForDebugging(c(u.id)),E(u),!0):n})),l.push(o.instead("transitionToGuild",B,function(e,n){const[i,u]=e;!r(u)&&typeof n=="function"&&n(e)})),l.push(o.instead("fetchMessages",I,function(e,n){const[i]=e;!r(i)&&typeof n=="function"&&n(e)})),l.push(o.instead("default",t,function(e,n){const i=e[0]?.channel;return!r(i)&&typeof n=="function"?n(...e):a.React.createElement(D,{channel:i})}))}var x={onLoad:_,onUnload:function(){for(const t of l)t()}};return g.default=x,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui,vendetta.ui.assets);
